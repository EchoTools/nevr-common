/**
 * The Nevr server RPC protocol for games and apps.
 */
syntax = "proto3";

package nevr.api;

import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option csharp_namespace = "Nevr.Protobuf";
option go_package = "github.com/echotools/nevr-common/v3/api";
option java_multiple_files = true;
option java_outer_classname = "NevrApi";
option java_package = "com.github.echotools.nevr.api";

// List game servers.
message ListServersRequest {
  // Limit the number of returned matches.
  google.protobuf.Int32Value limit = 1;
  // Arbitrary label query.
  google.protobuf.StringValue query = 6;
}

// List all users that are part of a group.
message ListGuildGameServersRequest {
  // The guild ID to list from.
  string guild_id = 1;
  // Max number of records to return. Between 1 and 100.
  google.protobuf.Int32Value limit = 2;
  // The game server state to list.
  google.protobuf.Int32Value state = 3;
  // Arbitrary label query.
  google.protobuf.StringValue query = 5;
  // An optional next page cursor.
  string cursor = 4;
}

message GuildGameServerList {
  // A single server-state pair.
  message GuildGameServer {
    // The server session status.
    enum State {
      // The server is inactive and cannot be connected to.
      INACTIVE = 0;
      // The session is active and can be connected to.
      ACTIVE = 1;
      // The session is closed and will be deleted soon.
      CLOSED = 2;
    }

    // Server.
    GameServer game_server = 1;
    // The user's relationship to the group.
    google.protobuf.Int32Value state = 2;
  }
  // Server-state pairs.
  repeated GuildGameServer guild_servers = 4;
  // An optional next page cursor.
  string cursor = 2;
}

// Game Server
message GameServer {
  // The id of the server.
  google.protobuf.UInt64Value server_id = 10;
  // The user ID of the owner of the server.
  google.protobuf.StringValue operator_id = 4;
  // The endpoint data used for client connections. (internal_ip:external_ip:port)
  google.protobuf.StringValue endpoint = 6;
  // The features of the server.
  repeated string supported_features = 11;
  // The timestep duration in nanoseconds.
  int32 timestep_nanos = 3;
  // Additional information about the server.
  map<string, string> metadata = 24;
}
